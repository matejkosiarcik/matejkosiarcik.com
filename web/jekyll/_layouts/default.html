{% capture bodyClass %}
  {% if page.layout == "post" %}
    blog-post
  {% else %}
    {{ page.name | regex_replace: "\..+$", "" }}
  {% endif %}
{% endcapture %}
{% assign bodyClass = bodyClass | strip %}

<!DOCTYPE html>
<html lang="en" class="no-js">
  {% include head.html %}
  <body class="{{ bodyClass }}">
    {% include header.html %}
    <main class="container content">
      {{ content }}
    </main>
    {% include footer.html %}

    <!-- polyfill for older browsers -->
    <!-- The integrity is wrong, which does not matter because it is meant for older browsers which do not (usually) support SRI -->
    <!-- If it catches few false positives doesn't matter, because the whole JS is just a progressive enhancement -->
    <!-- And the site is meant to function without it (it is just nicer when it works) -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=default" nomodule defer crossorigin="anonymous" integrity="sha384-..."></script>

    <!-- TODO: analytics -->
    {% if jekyll.environment == "production" %}
      {% assign analytics_url = "https://api2.matejkosiarcik.com/analytics" %}
    {% else %}
      {% assign analytics_url = "http://localhost:8083/analytics" %}
    {% endif %}
    <img src="{{ analytics_url }}" alt="Analytics" loading="eager" />

    {% if jekyll.environment == "production" %}
      <script src="/bundle.js" defer crossorigin="anonymous"></script>
    {% endif %}
  </body>
</html>
